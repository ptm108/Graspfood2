 insert into works(uid, dayno, startno, endno, hours, timestamp) 
values
 (125, 0, 12, 14, 2, '2020-04-15') ,
 (125, 0, 18, 20, 2, '2020-04-15') ,
 (125, 1, 10, 12, 2, '2020-04-15') ,
 (125, 1, 14, 16, 2, '2020-04-15') ,
 (125, 2, 11, 15, 3, '2020-04-15') ,
 (125, 2, 18, 20, 2, '2020-04-15') ,
 (125, 3, 10, 12, 2, '2020-04-15') ,
 (125, 3, 15, 18, 3, '2020-04-15') ;



 (125, 1, 10, 12, 2, '2020-04-08' ),
 (125, 1, 14, 16, 2, '2020-04-08' ),
 (125, 2, 11, 15, 3, '2020-04-08' ),
 (125, 2, 18, 20, 2, '2020-04-08' ),
 (125, 3, 10, 12, 2, '2020-04-08' ),
 (125, 3, 15, 18, 3, '2020-04-08' ),
 (125, 4, 10, 12, 2, '2020-04-08' ),
 (125, 4, 14, 16, 2, '2020-04-08' ),
 (125, 5, 11, 13, 2, '2020-04-08' ),
 (125, 5, 18, 20, 2, '2020-04-08') ,
 (125, 6, 14, 15, 1, '2020-04-08') ,
 (125, 6, 18, 21, 3, '2020-04-08') ,
 (125, 0, 12, 14, 2, '2020-04-08') ,
 (125, 0, 18, 20, 2, '2020-04-08') ,
 (125, 0, 12, 14, 2, '2020-04-15') ,
 (125, 0, 18, 20, 2, '2020-04-15') ,
 (125, 1, 10, 12, 2, '2020-04-15') ,
 (125, 1, 14, 16, 2, '2020-04-15') ,
 (125, 2, 11, 15, 3, '2020-04-15') ,
 (125, 2, 18, 20, 2, '2020-04-15') ,
 (125, 3, 10, 12, 2, '2020-04-15') ,
 (125, 3, 15, 18, 3, '2020-04-15') ,
 (125, 4, 10, 12, 2, '2020-04-15') ,
 (125, 4, 14, 16, 2, '2020-04-15') ,
 (125, 5, 11, 13, 2, '2020-04-15'),
 (125, 5, 18, 20, 2, '2020-04-15') ,
 (125, 6, 14, 15, 1, '2020-04-15') ,
 (125, 6, 18, 21, 3, '2020-04-15') ;

Create or replace function update_restaurant_rating()
Returns trigger as $$
DECLARE 
	totalrating NUMERIC;
	Newrid integer;
    BEGIN
	SELECT avg(rating), o.rid INTO totalrating, newrid
	FROM reviews r
  join orderplaced o on r.oid = o.oid
  Group by rid;
  UPDATE restaurant SET rating = totalrating WHERE rid = newrid;
  RETURN NEW;
END;
$$ LANGUAGE plpgsql;

 